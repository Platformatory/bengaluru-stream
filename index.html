<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bengaluru Streams | Real-Time Data Enthusiasts</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/images/data-engineer.png">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- tsParticles -->
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // New Color Palette
                        'twilight': '#03045e',      // Deep Twilight - Moody midnight shade
                        'french': '#023e8a',        // French Blue - Classic and bold
                        'teal': '#0077b6',          // Bright Teal Blue - Electric, aquatic
                        'green': '#0096c7',         // Oceanic blue and vibrant green
                        'surf': '#00b4d8',          // Turquoise Surf - Luminous energy
                        'aqua': '#48cae4',          // Sky Aqua - Sparkling blue
                        'frosted': '#90e0ef',       // Frosted Blue - Tranquility and freshness
                        'ice': '#ade8f4',           // Frosted Blue (lighter) - Icy blue
                        'cyan': '#caf0f8',          // Light Cyan - Delicate, sunlit blue

                        // Legacy colors for compatibility
                        'blue-base': '#03045e',
                        'blue-dark': '#023e8a',
                        'blue-text': '#48cae4',
                    },
                    fontFamily: {
                        sans: ['system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        @keyframes pulse-subtle {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.95;
                transform: scale(1.02);
            }
        }

        .animate-pulse-subtle {
            animation: pulse-subtle 3s ease-in-out infinite;
        }
    </style>
</head>

<body class="bg-blue-base text-white antialiased">

    <div id="hero-container"></div>
    <div id="upcoming-events-container"></div>
    <div id="about-container"></div>
    <!-- <div id="features-container"></div> Core Focus Areas -->
    <!-- <div id="speakers-container"></div> -->
    <div id="events-container"></div>
    <!-- <div id="testimonials-container"></div> -->
    <div id="sponsors-container"></div>
    <div id="talks-container"></div>
    <div id="discussions-container"></div>
    <div id="footer-container"></div>

    <script>
        const sections = [
            { id: 'hero-container', path: 'sections/hero.html' },
            { id: 'upcoming-events-container', path: 'sections/upcoming_events.html' },
            { id: 'about-container', path: 'sections/about.html' },
            // { id: 'features-container', path: 'sections/features.html' },
            // { id: 'speakers-container', path: 'sections/speakers.html' },
            { id: 'events-container', path: 'sections/events.html' },
            // { id: 'testimonials-container', path: 'sections/testimonials.html' },
            { id: 'sponsors-container', path: 'sections/sponsors.html' },
            { id: 'talks-container', path: 'sections/talks.html' },
            { id: 'discussions-container', path: 'sections/discussions.html' },
            { id: 'footer-container', path: 'sections/footer.html' }
        ];

        async function loadSections() {
            for (const section of sections) {
                try {
                    const response = await fetch(section.path);
                    if (response.ok) {
                        const html = await response.text();
                        document.getElementById(section.id).innerHTML = html;
                    }
                } catch (error) {
                    // console.error(`Error loading ${section.path}:`, error);
                }
            }

            // Initialize hero background slideshow after sections are loaded
            initHeroSlideshow();

            // Initialize talks carousel after sections are loaded
            initTalksCarousel();

            // Initialize sponsors carousel after sections are loaded
            initSponsorsCarousel();

            // Initialize Newsletter
            initNewsletter();

            // Initialize Footer Year
            initFooterYear();

            // Initialize particles after sections are loaded
            // initParticles();
        }

        // function initParticles() {
        //     // Check if tsparticles is loaded
        //     if (typeof tsParticles === 'undefined') {
        //         console.error('tsParticles library not loaded');
        //         return;
        //     }

        //     tsParticles.load("tsparticles", {
        //         fpsLimit: 60,
        //         fullScreen: { enable: false },
        //         particles: {
        //             number: {
        //                 value: 50,
        //                 density: {
        //                     enable: true,
        //                     area: 800
        //                 }
        //             },
        //             color: {
        //                 value: "#ffffff"
        //             },
        //             shape: {
        //                 type: "circle"
        //             },
        //             opacity: {
        //                 value: 0.5,
        //                 random: true,
        //                 animation: {
        //                     enable: true,
        //                     speed: 1,
        //                     minimumValue: 0.1,
        //                     sync: false
        //                 }
        //             },
        //             size: {
        //                 value: 3,
        //                 random: true,
        //                 animation: {
        //                     enable: false,
        //                     speed: 40,
        //                     minimumValue: 0.1,
        //                     sync: false
        //                 }
        //             },
        //             lineLinked: {
        //                 enable: true,
        //                 distance: 150,
        //                 color: "#48cae4", // Aqua color for links
        //                 opacity: 0.4,
        //                 width: 1
        //             },
        //             move: {
        //                 enable: true,
        //                 speed: 2,
        //                 direction: "none",
        //                 random: false,
        //                 straight: false,
        //                 outModes: {
        //                     default: "out"
        //                 },
        //                 attract: {
        //                     enable: false,
        //                     rotateX: 600,
        //                     rotateY: 1200
        //                 }
        //             }
        //         },
        //         interactivity: {
        //             detectsOn: "canvas",
        //             events: {
        //                 onHover: {
        //                     enable: true,
        //                     mode: "grab"
        //                 },
        //                 onClick: {
        //                     enable: true,
        //                     mode: "push"
        //                 },
        //                 resize: true
        //             },
        //             modes: {
        //                 grab: {
        //                     distance: 140,
        //                     lineLinked: {
        //                         opacity: 1
        //                     }
        //                 },
        //                 push: {
        //                     particles_nb: 4
        //                 }
        //             }
        //         },
        //         detectRetina: true
        //     });
        //     // console.log('Particles initialized');
        // }

        function initHeroSlideshow() {
            const images = document.querySelectorAll('.hero-bg-image');

            if (images.length === 0) {
                // console.log('No hero background images found');
                return;
            }

            // console.log(`Found ${images.length} hero background images`);
            let currentIndex = 0;

            function rotateImages() {
                // Fade out current image
                images[currentIndex].classList.remove('active');

                // Move to next image
                currentIndex = (currentIndex + 1) % images.length;

                // Fade in next image
                images[currentIndex].classList.add('active');

                // console.log(`Switched to image ${currentIndex + 1}`);
            }

            // Rotate images every 30 seconds
            setInterval(rotateImages, 30000);
            // console.log('Hero slideshow initialized - rotating every 30 seconds');
        }

        function initTalksCarousel() {
            const carousel = document.getElementById('talks-carousel');
            const leftBtn = document.getElementById('talks-scroll-left');
            const rightBtn = document.getElementById('talks-scroll-right');

            if (!carousel || !leftBtn || !rightBtn) {
                console.log('Talks carousel elements not found');
                return;
            }

            // console.log('Initializing talks carousel');

            // Manual scroll with buttons
            leftBtn.addEventListener('click', () => {
                carousel.scrollBy({ left: -620, behavior: 'smooth' });
            });

            rightBtn.addEventListener('click', () => {
                carousel.scrollBy({ left: 620, behavior: 'smooth' });
            });

            // Auto-scroll functionality
            let autoScrollInterval;
            let isUserScrolling = false;
            let scrollTimeout;

            function startAutoScroll() {
                autoScrollInterval = setInterval(() => {
                    if (!isUserScrolling) {
                        const maxScroll = carousel.scrollWidth - carousel.clientWidth;

                        if (carousel.scrollLeft >= maxScroll - 10) {
                            // Reset to start
                            carousel.scrollTo({ left: 0, behavior: 'smooth' });
                        } else {
                            // Scroll to next video
                            carousel.scrollBy({ left: 620, behavior: 'smooth' });
                        }
                    }
                }, 5000); // Auto-scroll every 5 seconds
            }

            // Pause auto-scroll when user manually scrolls
            carousel.addEventListener('scroll', () => {
                isUserScrolling = true;
                clearTimeout(autoScrollInterval); // Clear auto-scroll interval immediately
                clearTimeout(scrollTimeout);

                scrollTimeout = setTimeout(() => {
                    isUserScrolling = false;
                    startAutoScroll(); // Restart auto-scroll after user stops scrolling
                }, 3000); // Resume auto-scroll 3 seconds after user stops scrolling
            });

            // Start auto-scroll
            startAutoScroll();
            // console.log('Talks carousel initialized - auto-scrolling every 5 seconds');
        }

        function initSponsorsCarousel() {
            const carousel = document.getElementById('sponsors-carousel');

            if (!carousel) {
                return;
            }

            // Duplicate logos for seamless infinite scroll
            const originalContent = carousel.innerHTML;
            carousel.innerHTML += originalContent;

            let scrollPosition = 0;

            function continuousScroll() {
                scrollPosition += 1; // Scroll 1px per frame
                carousel.scrollLeft = scrollPosition;

                // Reset position seamlessly when halfway through
                const maxScroll = carousel.scrollWidth / 2;
                if (scrollPosition >= maxScroll) {
                    scrollPosition = 0;
                    carousel.scrollLeft = 0;
                }
                requestAnimationFrame(continuousScroll);
            }

            // Start continuous scroll - never stops
            continuousScroll();

            // Initialize Center Focus Observer
            // We use a timeout to ensure the layout is settled after duplication
            setTimeout(() => {
                const observerOptions = {
                    root: carousel,
                    // Define a VERY narrow center zone to ensure only one item is highlighted at a time
                    // 0px top, -48% right, 0px bottom, -48% left
                    // This means the effective viewport for intersection is the middle 4%
                    rootMargin: '0px -48% 0px -48%',
                    threshold: 0.1
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        const target = entry.target;
                        if (entry.isIntersecting) {
                            // Element is in the center zone
                            // Remove the inactive classes to make it look "active" (full color, opacity)
                            target.classList.remove('grayscale', 'opacity-60');
                            target.classList.add('grayscale-0', 'opacity-100');
                        } else {
                            // Element is leaving the center zone
                            // Re-add the inactive classes
                            target.classList.add('grayscale', 'opacity-60');
                            target.classList.remove('grayscale-0', 'opacity-100');
                        }
                    });
                }, observerOptions);

                // Observe all children (logos)
                Array.from(carousel.children).forEach(child => {
                    observer.observe(child);
                });
            }, 100);
        }

        function initNewsletter() {
            const form = document.getElementById('newsletter-form');
            const btn = document.getElementById('newsletter-btn');
            const emailInput = document.getElementById('newsletter-email');

            if (!form) return;

            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const email = emailInput.value;
                const originalBtnText = btn.innerText;

                // Visual feedback
                btn.innerText = 'Subscribing...';
                btn.disabled = true;
                btn.classList.add('opacity-70', 'cursor-not-allowed');

                // Google Apps Script Web App URL
                const scriptURL = 'https://script.google.com/macros/s/AKfycbyayyey9USOaZxtSngEraVwhvl6IDcf4QHA0AUCccznFdrnAnRA8r0DQktkAJwRaxAziQ/exec';

                // Use URLSearchParams for application/x-www-form-urlencoded
                // This is much more reliable with Google Apps Script than JSON
                const formData = new URLSearchParams();
                formData.append('email', email);

                fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: formData.toString()
                })
                    .then(response => {
                        // Assume success since 'no-cors' hides the status
                        btn.innerText = 'Subscribed!';
                        form.reset();

                        setTimeout(() => {
                            btn.innerText = originalBtnText;
                            btn.disabled = false;
                            btn.classList.remove('opacity-70', 'cursor-not-allowed');
                        }, 3000);
                    })
                    .catch(error => {
                        console.error('Error!', error.message);
                        btn.innerText = 'Error! Try again.';
                        setTimeout(() => {
                            btn.innerText = originalBtnText;
                            btn.disabled = false;
                            btn.classList.remove('opacity-70', 'cursor-not-allowed');
                        }, 3000);
                    });
            });
        }

        function initFooterYear() {
            const yearSpan = document.getElementById('current-year');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }
        }
        loadSections();
    </script>
</body>

</html>