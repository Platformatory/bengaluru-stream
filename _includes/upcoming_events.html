{% assign current_date_ts = site.time | date: '%Y-%m-%d' | date: '%s' %}
{% assign events_count = 0 %}
{% assign shown_count = 0 %}
{% assign limit = 2 %}

{% assign sorted_events = site.events | sort: "date" %}

<!-- First pass to count upcoming events -->
{% for event in sorted_events %}
{% assign event_ts = event.date | date: '%s' %}
{% if event_ts >= current_date_ts %}
{% assign events_count = events_count | plus: 1 %}
{% endif %}
{% endfor %}

{% if events_count > 0 %}
<section
    class="bg-gradient-to-b from-french via-[#00509d] to-french py-8 px-4 md:px-8 border-b border-white/5 relative overflow-hidden">
    <!-- Background Elements -->
    <div
        class="absolute inset-0 bg-[url('/assets/images/bengaluru_streams.png')] opacity-5 bg-center bg-no-repeat bg-cover pointer-events-none">
    </div>

    <div class="max-w-7xl mx-auto relative z-10">
        <!-- Section Header -->
        <div class="flex items-center gap-4 mb-6">
            <div class="h-8 w-1 bg-aqua rounded-full"></div>
            <h2 class="text-2xl md:text-3xl font-black text-white uppercase tracking-wide">
                Upcoming Events
            </h2>
            <div class="hidden md:block h-[1px] flex-1 bg-gradient-to-r from-white/20 to-transparent"></div>
        </div>

        <div class="flex flex-col gap-6">
            {% for event in sorted_events %}
            {% assign event_ts = event.date | date: '%s' %}
            {% if event_ts >= current_date_ts %}
            {% if shown_count < limit %} {% include event-card.html event=event %} {% assign shown_count=shown_count |
                plus: 1 %} {% endif %} {% endif %} {% endfor %} </div>

                {% if events_count > limit %}
                <div class="text-center mt-8">
                    <a href="/events"
                        class="inline-flex items-center justify-center px-8 py-3 bg-white/10 text-white font-bold text-sm md:text-base rounded-full hover:bg-aqua hover:text-twilight transition-all border border-white/20 hover:border-aqua/50 group">
                        More Upcoming Events
                        <i class="fa-solid fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
                    </a>
                </div>
                {% endif %}
        </div>
</section>
{% endif %}